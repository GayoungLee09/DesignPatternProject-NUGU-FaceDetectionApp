# DesignPatternProject-NUGU-FaceDetectionApp
## 1. 프로젝트 개요

### 1) 프로젝트 소개

 실시간 얼굴 인식을 이용하여 방문자의 출입을 관리할 수 있는 앱을 제작하는 것입니다. 코로나 19 이후 방역 및 위생관리가 강화되어야 한다는 인식이 커지면서 건물 출입 관리가 중요시되었습니다. 하지만 지문인식의 경우 인식 단말기에 직접 접촉해야 하기 때문에 감염병 확산에 취약하다는 점이 단점으로 지적되면서, 비접촉 방식이 부상하고 있습니다. 따라서 저는 간단하면서 효율적인 Local binary pattern(LBP)를 이용해 얼굴을 인식하여 건물 출입을 관리할 수 있는 앱을 제작하고자 합니다.

## 2. 목표 및 내용

### 1) 최종 목표

 사용자의 얼굴을 인식하고 방문기록을 저장하는 ‘인식하기’, 사용자의 얼굴을 시스템에 등록하는 ‘등록하기’, 누적된 방문기록을 확인하는 ‘조회하기’ 3가지 기능을 제공하고 직관적이고 깔끔한 디자인의 사용자 인터페이스(UI)를 제작하는 것입니다.



### 2) 적용된 패턴의 종류 및 방법

- Adapter pattern

  main 화면에서 현재 날짜와 시간을 UI로 전달해주는 과정에 adapter pattern을 적용하였습니다. 날짜와 시간을 일정한 format으로 감싸주어 retun 해 UI로 전달해주게 됩니다. 저는 상속받는 adapter pattern을 적용하였고 아래에서 Show 클래스는 adaptee, Date_info 클래스는 target, ShowDate_info 클래스는 adapter입니다.
 <br/>

- Facade pattern

  얼굴을 등록하고 얼굴을 인식하는 과정을 간단하게 제공하기 위해 facade패턴을 적용하였습니다. 
 <br/>

- Observer pattern

  사용자 인터페이스의 화면 상태가 변화할 때 애니메이션 효과가 제대로 적용되었는지, 화면이 제대로 변경되었는지를 기술하기 위하여 observer pattern을 적용하였습니다. 
 코드 실행 결과 맨 아래의 사진과 같이 UI에 애니메이션 효과가 적용되었고 화면이 제대로 변경되었다는 것을 알 수 있습니다.
 <br/>
 


### 3) 주요 코드 및 설명

전체적인 코드 설명은 첨부한 소스코드에 주석 처리하여 설명하였습니다.

- 얼굴 등록 코드

  cascade classifier(다단계 분류)를 이용하여 객체 검출(object detection)을 통해 얼굴을 검출하였습니다. 검출한 얼굴 부위만 이미지로 만들고 리턴하였습니다.
입력된 이름의 폴더를 생성하고 카메라를 실행한 후 얼굴 추출 함수를 통해 얼굴만 추출하여 200x200 사이즈인 100장의 흑백 사진을 faces/사용자이름/userxx.jpg 로 저장합니다.(xx는 1~100)
 <br/>
 
- 얼굴 학습 코드

  LBP(Local Binary Pattern) 을 이용하여 model을 수집한 100장의 training data로 학습하였습니다.
 <br/>
 
- 얼굴 인식 코드

  카메라를 실행한 후 얼굴 추출 함수를 통해 얼굴만 추출하여 200x200 사이즈의 흑백 사진을 학습한 모델을 이용하여 얼굴을 인식합니다. min_score는 신뢰도(유사도)를 의미하며 0에 가까울수록 해당 인물과 같다는 것을 의미합니다. min score가 75이상이면 해당 인물이라고 인식하여 텍스트 파일에 기록하고 카메라가 종료됩니다. 75 이하이면 미등록인으로 간주하고 카메라가 종료됩니다. 만약 카메라 화면 속에서 얼굴이 검출되지 않는 경우는 예외처리하여 다시 시도하도록 하였습니다.
 <br/>
 

## 3. 결과 및 느낀점

### 1) 결과 화면 및 설명

- main 화면은 아래의 사진과 같으며 코드를 실행하였을 때 배경에 애니메이션 효과가 적용되어 아래에서 화면이 올라옵니다. main 화면에서 현재 날짜와 시간을 확인할 수 있으며 이름 입력란, 얼굴을 등록하는 ‘REGISTER’ 버튼, 얼굴을 인식하는 ‘RECOGNITION’ 버튼, 방문기록을 조회하는 ‘CHECK VISITOR’ 버튼, 앱을 종료하는 ‘EXIT’버튼이 있습니다.
<img width="30%" src="https://user-images.githubusercontent.com/81952512/235420818-73649c7b-bc14-4739-a404-629088e9e701.png"/>

 <br/>
 
- 얼굴을 등록하고 싶은 경우

  main 화면에서 이름 입력란에 영문 이름을 입력하고 ‘REGISTER’ 버튼을 클릭합니다. 내장된 카메라가 켜지며 카메라 속 화면에서 얼굴 부분만 crop 되어 사용자의 얼굴 사진을 저장합니다. 100장의 사진을 추출하면 카메라가 꺼지고 등록하는 과정이 끝납니다.
 <img width="30%" src="https://user-images.githubusercontent.com/81952512/235423177-0a6e94d4-5fc4-4937-b19c-62fae06b6d83.png"/> <img width="8%" src="https://user-images.githubusercontent.com/81952512/235421659-06ad7551-8dfb-4a4f-824b-7a82012a59ca.png"/>
 <br/>
 
- 얼굴을 인식하고 싶은 경우

  main 화면에서 ‘RECOGNITION’ 버튼을 클릭하면 내장된 카메라가 켜지며 얼굴 인식을 시작합니다. 화면 속 인식한 얼굴 부분을 bounding box로 표시하고 인식한 인물의 이름과 유사도를 화면에 표시합니다. 유사도가 75 이상이면 해당 인물이라고 인식하여 ‘verified : 해당 인물 이름’을 카메라 속 화면에 표시하고 이름, 날짜, 시간을 텍스트 파일에 기록합니다. 유사도가 75 이하이면 미등록인으로 간주하고 ‘unverified’을 카메라 속 화면에 표시합니다.

<img width="30%" alt="image" src="https://user-images.githubusercontent.com/81952512/235423350-191f1465-7e99-4a2e-8f5b-133da1eb2fc0.png"/> <img width="27%" src="https://user-images.githubusercontent.com/81952512/235421909-ec07f216-011f-4de2-b8e5-b9094ab64a99.png"/>

  인식이 잘 된 것을 확인할 수 있습니다.

  이전에 등록해 둔 연예인 사진을 예시로 들어 추가 인식된 결과를 첨부하였습니다.
  
  <img width="27%" src="https://user-images.githubusercontent.com/81952512/235422358-72c26d28-7628-46a5-8e0c-b3108e981dca.png"/> <img width="27%" src="https://user-images.githubusercontent.com/81952512/235422452-b2665f7e-5570-4bde-88d4-5b220c0bd6b6.png"/>
  
  다른 두 사진 모두에서 아이유를 잘 인식한 것을 확인할 수 있습니다.
   <br/>
   <br/>
   
   
  - 방문기록을 조회하고 싶은 경우

  main 화면에서 ‘CHECK VISITOR’ 버튼을 클릭하면 텍스트 파일에 방문자, 방문날짜, 방문시간이 기록된 방문기록을 확인할 수 있습니다. 스크롤 바를 내려 확인할 수 있고 main 화면으로 돌아가고 싶은 경우 맨 아래의 ‘BACK TO MAIN’ 버튼을 클릭하면 됩니다.
  
  <img width="30%" alt="image" src="https://user-images.githubusercontent.com/81952512/235423459-53161cb0-a8c9-4c9b-9458-b74d4214a955.png"/> <img width="30%" alt="image" src="https://user-images.githubusercontent.com/81952512/235423502-5a7f8264-2817-4184-92f7-a6c56915ca7f.png"/>
   
  위 사진에서 확인할 수 있듯이 테스트해본 결과들이 잘 기록된 것을 확인할 수 있습니다.
  <br/>
  <br/>
  

### 2) 느낀 점

프로젝트를 통해 프로그래밍 언어의 이해도가 증가하였고 코드 작성방법과 구조를 읽는 데 도움이 되었습니다. 

또한 지저분했던 함수들에 Facade pattern을 적용하여 함수들이 정리되고 간단하게 제공될 수 있는 과정을 보며, 디자인패턴의 중요성과 편리함을 더욱 느낄 수 있었습니다.

그리고 프로젝트를 수행하기 위해 적용 가능한 패턴들을 찾아보며 디자인 패턴들을 자세히 공부하고 이해하는 시간이 되었습니다.

더욱 다양한 패턴을 적용해보고 싶었지만 kv파일의 특성상 class와 함수로 표현할 수 없는 한계가 있어 아쉬움을 느꼈습니다.

